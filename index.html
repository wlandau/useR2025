<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-53f539a478d6ecd1be31ce9fd30fd81c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/quarto-contrib/qrcodejs-v1.0.0/qrcode.js"></script><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.26">

  <title>index</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link rel="stylesheet" href="style.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="section" class="slide level2">
<h2></h2>
<style>
.reveal .tiny {
  display: inline-block;
  font-size: 0.5em;
  line-height: 1.0em;
  vertical-align: top;
}
.reveal .medium {
  display: inline-block;
  font-size: 0.75em;
  line-height: 1.5em;
  vertical-align: top;
}
pre code {
  overflow-x: hidden !important;
}
</style>
<center>
<br>
<h3>
Powerful simulation pipelines with {targets}
</h3>
<img src="./images/targets.png" height="400px"> <br>
<h4>
Will Landau
</h4>
</center>
<aside class="notes">
<p>One of the things we’ve seen at this conference is that we’re using R more and more in the life sciences. For industrial biomedical research. I want to share with you, not only a tool but a whole paradigm, that’s really helped me and my colleagues for many years in this space.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="modeling-and-simulation" class="slide level2" style="font-size: 1.1em">
<h2>Modeling and simulation</h2>

<img data-src="./images/compiling.png" class="quarto-figure quarto-figure-center r-stretch"><p><span style="font-size: 0.5em">Credit: <a href="https://xkcd.com/303/">https://xkcd.com/303/</a>, Randal Munroe</span></p>
<aside class="notes">
<p>But first, let’s revisit one of our favorite webcomics. This comic is famous and forever memorialized in the history of the internet because reveals such a relatable unspoken reality in software engineering. You write a program, but then before you use it, you have to let it compile. And while it compiles, there’s nothing for you to do. You just have to sit there and let the computer do its thing.</p>
<p>And I know, not all of us are professional software engineers. We’re statisticians, mathematicians, ecologists, economists, geneticists, quantitative scientists of all kinds. But still… this is us… all the time.</p>
<p>Only instead of “my code is compiling”, it’s usually: “my model is fitting”, or “my simulation is running”. And instead of slacking off and having sword fights in the office…</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="disruption-and-repetition" class="slide level2">
<h2>Disruption and repetition</h2>

<img data-src="./images/sisyphus.svg" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<p>…we’re disrupted. And delayed. It’s painful. And it’s extra painful because we have to repeat the models. We have to repeat the simulations. Until we get them right. But we can cut down on the pain with pipelines.</p>
<p>And that’s what I want to talk about with you today: how did we get into this predicament in the first place, and how do we manage the burden with pipelines?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section>
<section id="clinical-trial-simulation" class="title-slide slide level1 center">
<h1>Clinical trial simulation</h1>

</section>
<section id="drug-development" class="slide level2">
<h2>Drug development</h2>
<center>
<img src="./images/process.png">
</center>
</section>
<section id="clinical-trials" class="slide level2">
<h2>Clinical trials</h2>
<center>
<img src="./images/clinical.png">
</center>
</section>
<section id="responsibilities" class="slide level2">
<h2>Responsibilities</h2>
<center>
<img src="./images/responsibility.png">
</center>
</section>
<section id="clinical-trial-simulation-goals" class="slide level2">
<h2>Clinical trial simulation: goals</h2>
<center>
<img src="./images/goals.jpg" height="300px">
</center>
<div class="fragment">
<p>Quantify decision-making ability.</p>
</div>
<div class="fragment">
<p>Compare alternative designs.</p>
</div>
</section>
<section id="clinical-trial-simulation-steps" class="slide level2">
<h2>Clinical trial simulation: steps</h2>
<center>
<img src="./images/steps.jpg" height="300px">
</center>
<ol type="1">
<li class="fragment">Simulate virtual patients.</li>
<li class="fragment">Analyze with models.</li>
<li class="fragment">Repeat thousands of times.</li>
</ol>
</section>
<section id="clinical-trial-simulation-challenges" class="slide level2">
<h2>Clinical trial simulation: challenges</h2>
<center>
<img src="./images/challenges.jpg" height="300px">
</center>
<div class="fragment">
<p>Complicated R code.</p>
</div>
<div class="fragment">
<p>Long execution times.</p>
</div>
<div class="fragment">
<p>Frequent changes.</p>
</div>
</section></section>
<section>
<section id="example-trial" class="title-slide slide level1 center">
<h1>Example trial</h1>

</section>
<section id="hypothetical-trial" class="slide level2">
<h2>Hypothetical trial</h2>
<center>
<img src="./images/stethoscope.jpg" height="300px">
</center>
<div class="fragment">
<p>Extremely rare and severe autoimmune liver disease.</p>
</div>
<div class="fragment">
<p>Phase 2A study, first look at efficacy.</p>
</div>
<div class="fragment">
<p>Double blind: novel therapy vs standard of care.</p>
</div>
<div class="fragment">
<p>Randomize up to 100 patients (1:1).</p>
</div>
</section>
<section id="bayesian-joint-model" class="slide level2 nonincremental">
<h2>Bayesian joint model</h2>
<div class="fragment">
<h4 id="longitudinal-endpoint-log-bilirubin">Longitudinal endpoint: log bilirubin</h4>
<p><span class="math display">\[
\begin{aligned}
\color{orange}{\eta_i(t)} = x_i(t) \beta + b_i
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="math inline">\(\color{orange}{\eta_i(t)}\)</span>: expected log bilirubin for patient <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</p>
<div class="fragment">
<h4 id="survival-endpoint-years-without-liver-transplant-or-death">Survival endpoint: years without liver transplant or death</h4>
<p><span class="math display">\[
\begin{aligned}
h_i(t) = h_0(t, \lambda) \exp \left (\color{orange}{\eta_i(t)} \alpha + d_i \color{blue}{\theta} \right )
\end{aligned}
\]</span></p>
</div>
</div>
<div class="fragment">
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="math inline">\(d_i\)</span>: 1 for treatment, 0 for control.</p>
</div>
<div class="fragment">
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="math inline">\(\color{blue}{\theta}\)</span>: log hazard ratio of treatment vs control.</p>
</div>
</section>
<section id="decision-rules" class="slide level2 nonincremental">
<h2>Decision rules</h2>
<p><span class="math display">\[
\begin{aligned}
g(y) = \text{P}(\exp(\color{blue}{\theta}) &lt; 0.75 \ | \ y)
\end{aligned}
\]</span></p>
<div class="fragment">
<h4 id="declare-efficacy-if">Declare efficacy if:</h4>
<p><span class="math display">\[
\begin{aligned}
g(y) &gt; 0.8
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<h4 id="declare-futility-if">Declare futility if:</h4>
<p><span class="math display">\[
\begin{aligned}
g(y) &lt; 0.4
\end{aligned}
\]</span></p>
</div>
</section>
<section id="clinical-trial-design" class="slide level2">
<h2>Clinical trial design</h2>
<center>
<img src="./images/stethoscope.jpg" height="300px">
</center>
<div class="fragment">
<p>10-year accrual period.</p>
</div>
<div class="fragment">
<p>Futility interim at <span class="math inline">\(n\)</span> events (liver transplant or death).</p>
</div>
<div class="fragment">
<p><strong>Goal: simulate to propose a suitable <span class="math inline">\(n\)</span></strong>.</p>
</div>
</section>
<section id="simulate-futility" class="slide level2">
<h2>Simulate futility</h2>

<img data-src="./images/bayes.png" class="r-stretch"><div class="fragment">
<p>Simulate 10000 futile trials for <span class="math inline">\(n = 40, 50, 60, 70\)</span>.</p>
</div>
<div class="fragment">
<p>A fixed hazard ratio of 1 would be unrealistic.</p>
</div>
<div class="fragment">
<p>Instead, draw from a distribution that captures futility.</p>
</div>
<div class="fragment">
<p>Use the posterior distribution from a historical trial.</p>
</div>
</section>
<section id="historical-futility-data" class="slide level2">
<h2>Historical futility data</h2>
<center>
<img src="./images/data.jpg" height="300px">
</center>
<div class="fragment">
<p>Datasets <code>pbc</code> and <code>pbcseq</code> from the <code>survival</code> package.</p>
</div>
<div class="fragment">
<p>Indication: primary biliary cholangitis (PBC).</p>
</div>
<div class="fragment">
<p>Mayo Clinic trial of D-penicillamine vs placebo.</p>
</div>
<div class="fragment">
<p>D-penicillamine did not improve survival.</p>
</div>
</section>
<section id="estimated-hazard-ratio" class="slide level2">
<h2>Estimated hazard ratio</h2>
<center>
<img src="./images/hazard_ratio.png">
</center>
</section></section>
<section>
<section id="r-code" class="title-slide slide level1 center">
<h1>R code</h1>

</section>
<section id="functions" class="slide level2 nonincremental">
<h2>Functions</h2>
<p><span class="math display">\[
\Huge
{\color{blue}{y}} = {\color{purple}{f}}({\color{teal}{x}})
\]</span> <br></p>
<blockquote>
<p>Everything that exists in an object. <br> Everything that happens is a function call.</p>
<p><br> — John Chambers</p>
</blockquote>
</section>
<section id="top-level-r-functions" class="slide level2">
<h2>Top-level R functions</h2>
<p><span class="math display">\[
\Huge
{\color{blue}{y}} = {\color{purple}{f}}({\color{teal}{x}})
\]</span></p>
<p><br></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>draw_hazard_ratios()</code></td>
<td>From historical model.</td>
</tr>
<tr class="even">
<td><code>trial()</code></td>
<td>Simulate one trial rep.</td>
</tr>
<tr class="odd">
<td><code>plot_results()</code></td>
<td>Visualize results.</td>
</tr>
</tbody>
</table>
</section>
<section id="example-simulation-replication" class="slide level2">
<h2>Example simulation replication</h2>
<center>
<img src="./images/r.png" height="200px">
</center>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">trial</span>(<span class="at">hazard_ratio =</span> <span class="fl">0.5</span>, <span class="at">events =</span> <span class="dv">50</span>)</span>
<span id="cb1-2"><a href=""></a><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span id="cb1-3"><a href=""></a><span class="co">#&gt;   events efficacy enrolled years</span></span>
<span id="cb1-4"><a href=""></a><span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb1-5"><a href=""></a><span class="co">#&gt; 1     50    0.998       83  8.52</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-simulation-replication-1" class="slide level2">
<h2>Example simulation replication</h2>
<center>
<img src="./images/r.png" height="200px">
</center>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">trial</span>(<span class="at">hazard_ratio =</span> <span class="dv">1</span>, <span class="at">events =</span> <span class="dv">50</span>)</span>
<span id="cb2-2"><a href=""></a><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span id="cb2-3"><a href=""></a><span class="co">#&gt;   events efficacy enrolled years</span></span>
<span id="cb2-4"><a href=""></a><span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb2-5"><a href=""></a><span class="co">#&gt; 1     50   0.0324       72  7.35</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="all-together-informally" class="slide level2">
<h2>All together, informally</h2>
<p>Step 1: draw historical hazard ratios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>hazard_ratios <span class="ot">&lt;-</span> <span class="fu">draw_hazard_ratios</span>(<span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Step 2: run simulations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>results <span class="ot">&lt;-</span> hazard_ratios <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href=""></a>  <span class="fu">expand_grid</span>(<span class="at">events =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href=""></a>  <span class="fu">pmap</span>(trial) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href=""></a>  <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Step 3: plot results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">plot_results</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section>
<section>
<section id="workflow-challenges" class="title-slide slide level1 center">
<h1>Workflow challenges</h1>

</section>
<section id="implementing-the-joint-model" class="slide level2">
<h2>Implementing the joint model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>rstanarm<span class="sc">::</span><span class="fu">stan_jm</span>(</span>
<span id="cb6-2"><a href=""></a>  <span class="at">formulaLong =</span> log_bilirubin <span class="sc">~</span></span>
<span id="cb6-3"><a href=""></a>    study_arm <span class="sc">+</span> albumin <span class="sc">+</span> years_measured <span class="sc">+</span></span>
<span id="cb6-4"><a href=""></a>    (<span class="dv">1</span> <span class="sc">|</span> patient_id),</span>
<span id="cb6-5"><a href=""></a>  <span class="at">formulaEvent =</span> <span class="fu">Surv</span>(years_survived, event) <span class="sc">~</span></span>
<span id="cb6-6"><a href=""></a>    study_arm,</span>
<span id="cb6-7"><a href=""></a>  <span class="at">time_var =</span> <span class="st">"years_measured"</span>,</span>
<span id="cb6-8"><a href=""></a>  <span class="at">dataLong =</span> data_longitudinal,</span>
<span id="cb6-9"><a href=""></a>  <span class="at">dataEvent =</span> data_survival</span>
<span id="cb6-10"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="backend-stan" class="slide level2">
<h2>Backend: Stan</h2>
<p><br></p>

<img data-src="./images/stan.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="computational-demands-of-stanhmc" class="slide level2">
<h2>Computational demands of Stan/HMC</h2>

<img data-src="./images/hmc.png" class="quarto-figure quarto-figure-center r-stretch"><div class="fragment">
<p>HMC = Hamiltonian Monte Carlo.</p>
</div>
<div class="fragment">
<p>Physics simulation samples from the posterior distribution.</p>
</div>
</section>
<section id="computation-time" class="slide level2">
<h2>Computation time</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="fu">system.time</span>(<span class="fu">draw_hazard_ratios</span>())</span>
<span id="cb7-2"><a href=""></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb7-3"><a href=""></a><span class="co">#&gt; 658.306   2.424 177.468 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">system.time</span>(<span class="fu">trial</span>(<span class="dv">1</span>, <span class="at">events =</span> <span class="dv">70</span>))</span>
<span id="cb8-2"><a href=""></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb8-3"><a href=""></a><span class="co">#&gt; 115.568   0.726  32.261 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p><span style="font-weight: bold; color: brown; font-size:1.25em"> 32 seconds x 10000 reps x 4 scenarios <span class="math inline">\(&gt;\)</span> 2 weeks! </span></p>
</div>
</section>
<section id="numbered-notebooks" class="slide level2">
<h2>Numbered notebooks?</h2>
<center>
<img src="./images/notebook-start.png">
</center>
</section>
<section id="what-about-data" class="slide level2">
<h2>What about data?</h2>
<center>
<img src="./images/notebook-data.png">
</center>
</section>
<section id="complexity" class="slide level2">
<h2>Complexity?</h2>
<center>
<img src="./images/notebook-change.png">
</center>
</section>
<section id="keeping-results-up-to-date" class="slide level2">
<h2>Keeping results up to date?</h2>
<center>
<img src="./images/notebook-rerun.png">
</center>
</section></section>
<section>
<section id="pipelines" class="title-slide slide level1 center">
<h1>Pipelines</h1>

</section>
<section id="what-is-a-pipeline" class="slide level2">
<h2>What is a pipeline?</h2>
<center>
<img src="./images/graph-final.png" height="300px">
</center>
<div class="fragment">
<p>A pipeline is a formal group of tasks.</p>
</div>
<div class="fragment">
<p>Each task has dependencies, a command, and output.</p>
</div>
<div class="fragment">
<p>A task can only modify its own output.</p>
</div>
<div class="fragment">
<p>A task cannot eventually depend on itself.</p>
</div>
</section>
<section id="pipeline-tools" class="slide level2">
<h2>Pipeline tools</h2>
<p><br></p>
<center>
<img src="./images/infographic.png" height="300px">
</center>
<p>Examples: Make, Airflow, Nextflow, Prefect, and <code>targets</code>.</p>
</section>
<section id="targets-a-pipeline-tool-for-r" class="slide level2">
<h2>targets: a pipeline tool for R</h2>
<center>
<img src="./images/logo-tweet.png" height="300px">
</center>
<div class="fragment">
<p>Retains the comfort of your local R session.</p>
</div>
<div class="fragment">
<p>Focuses on your functions, not your scripts.</p>
</div>
<div class="fragment">
<p>Integrates with Quarto.</p>
</div>
<div class="fragment">
<p>Runs distributed computing.</p>
</div>
</section></section>
<section>
<section id="trial-simulation-pipeline" class="title-slide slide level1 center">
<h1>Trial simulation pipeline</h1>

</section>
<section id="project-oriented-workflow" class="slide level2">
<h2>Project-oriented workflow</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>fs<span class="sc">::</span><span class="fu">dir_tree</span>()</span>
<span id="cb9-2"><a href=""></a><span class="co">#&gt; _targets.R</span></span>
<span id="cb9-3"><a href=""></a><span class="co">#&gt; R</span></span>
<span id="cb9-4"><a href=""></a><span class="co">#&gt; ├── draw_hazard_ratios.R</span></span>
<span id="cb9-5"><a href=""></a><span class="co">#&gt; ├── plot_results.R</span></span>
<span id="cb9-6"><a href=""></a><span class="co">#&gt; ├── trial.R</span></span>
<span id="cb9-7"><a href=""></a><span class="co">#&gt; └── utils.R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><code>R/</code> scripts contain functions.</p>
</div>
<div class="fragment">
<p><code>_targets.R</code> defines the pipeline.</p>
</div>
</section>
<section id="define-the-pipeline-in-_targets.r" class="slide level2">
<h2>Define the pipeline in _targets.R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">library</span>(targets)</span>
<span id="cb10-2"><a href=""></a></span>
<span id="cb10-3"><a href=""></a><span class="fu">tar_option_set</span>(...)</span>
<span id="cb10-4"><a href=""></a></span>
<span id="cb10-5"><a href=""></a><span class="fu">tar_source</span>()</span>
<span id="cb10-6"><a href=""></a></span>
<span id="cb10-7"><a href=""></a><span class="fu">list</span>(</span>
<span id="cb10-8"><a href=""></a>  <span class="fu">tar_target</span>(hazard_ratios, ...),</span>
<span id="cb10-9"><a href=""></a>  <span class="fu">tar_target</span>(trials, ...),</span>
<span id="cb10-10"><a href=""></a>  ...</span>
<span id="cb10-11"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="options-and-parallel-computing" class="slide level2">
<h2>Options and parallel computing</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="fu">library</span>(crew.cluster)</span>
<span id="cb11-2"><a href=""></a></span>
<span id="cb11-3"><a href=""></a>controller <span class="ot">&lt;-</span> <span class="fu">crew_controller_sge</span>(</span>
<span id="cb11-4"><a href=""></a>  <span class="at">workers =</span> <span class="dv">500</span>,</span>
<span id="cb11-5"><a href=""></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb11-6"><a href=""></a>  <span class="at">seconds_idle =</span> <span class="dv">120</span></span>
<span id="cb11-7"><a href=""></a>)</span>
<span id="cb11-8"><a href=""></a></span>
<span id="cb11-9"><a href=""></a><span class="fu">tar_option_set</span>(</span>
<span id="cb11-10"><a href=""></a>  <span class="at">packages =</span> <span class="fu">c</span>(<span class="st">"rstanarm"</span>, ...),</span>
<span id="cb11-11"><a href=""></a>  <span class="at">controller =</span> controller</span>
<span id="cb11-12"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inputs" class="slide level2">
<h2>Inputs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb12-2"><a href=""></a>  <span class="at">name =</span> events,</span>
<span id="cb12-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>)</span>
<span id="cb12-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><br></p>
<p>Equivalent to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="cf">function</span>() {</span>
<span id="cb13-2"><a href=""></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>)</span>
<span id="cb13-3"><a href=""></a>  <span class="fu">saveRDS</span>(result, <span class="st">"_targets/objects/events"</span>)</span>
<span id="cb13-4"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="inputs-1" class="slide level2">
<h2>Inputs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb14-2"><a href=""></a>  <span class="at">name =</span> hazard_ratios,</span>
<span id="cb14-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">draw_hazard_ratios</span>(<span class="dv">10000</span>)</span>
<span id="cb14-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="fragment">
<p>Equivalent to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="cf">function</span>(draw_hazard_ratios) {</span>
<span id="cb15-2"><a href=""></a>  result <span class="ot">&lt;-</span> <span class="fu">draw_hazard_ratios</span>(<span class="dv">10000</span>)</span>
<span id="cb15-3"><a href=""></a>  <span class="fu">saveRDS</span>(result, <span class="st">"_targets/objects/hazard..."</span>)</span>
<span id="cb15-4"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="simulations" class="slide level2">
<h2>Simulations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb16-2"><a href=""></a>  <span class="at">name =</span> trials,</span>
<span id="cb16-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">trial</span>(hazard_ratios, events),</span>
<span id="cb16-4"><a href=""></a>  <span class="at">pattern =</span> <span class="fu">cross</span>(hazard_ratios, events)</span>
<span id="cb16-5"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><br></p>
<p>For each combination of hazard ratio and event threshold:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="cf">function</span>(trial, hazard_ratio, event) {</span>
<span id="cb17-2"><a href=""></a>  result <span class="ot">&lt;-</span> <span class="fu">trial</span>(hazard_ratio, event)</span>
<span id="cb17-3"><a href=""></a>  <span class="fu">saveRDS</span>(result, <span class="st">"_targets/objects/trials..."</span>)</span>
<span id="cb17-4"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb18-2"><a href=""></a>  <span class="at">name =</span> plot,</span>
<span id="cb18-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">plot_results</span>(trials)</span>
<span id="cb18-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="fragment">
<p>Equivalent to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="cf">function</span>(plot_results, trials) {</span>
<span id="cb19-2"><a href=""></a>  result <span class="ot">&lt;-</span> <span class="fu">plot_results</span>(trials)</span>
<span id="cb19-3"><a href=""></a>  <span class="fu">saveRDS</span>(result, <span class="st">"_targets/objects/events"</span>)</span>
<span id="cb19-4"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="results-1" class="slide level2">
<h2>Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a>tarchetypes<span class="sc">::</span><span class="fu">tar_quarto</span>(</span>
<span id="cb20-2"><a href=""></a>  <span class="at">name =</span> quarto,</span>
<span id="cb20-3"><a href=""></a>  <span class="at">path =</span> <span class="st">"results.qmd"</span></span>
<span id="cb20-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="fragment">
<p>Equivalent to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="cf">function</span>(path, plot) {</span>
<span id="cb21-2"><a href=""></a>  quarto<span class="sc">::</span><span class="fu">quarto_render</span>(path)</span>
<span id="cb21-3"><a href=""></a>  <span class="fu">c</span>(<span class="st">"results.html"</span>, path)</span>
<span id="cb21-4"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="quarto-report" class="slide level2">
<h2>Quarto report</h2>
<center>
<img src="./images/quarto-source.png" height="550px">
</center>
</section>
<section id="graph-visualization" class="slide level2">
<h2>Graph visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">tar_visnetwork</span>(<span class="at">targets_only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<center>
<img src="./images/graph-outdated.png">
</center>
</section>
<section id="implicit-dependencies" class="slide level2">
<h2>Implicit dependencies</h2>
<center>
<img src="./images/graph-dependencies.png">
</center>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb23-2"><a href=""></a>  <span class="at">name =</span> plot,</span>
<span id="cb23-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">plot_results</span>(trials)</span>
<span id="cb23-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="running-the-pipeline" class="title-slide slide level1 center">
<h1>Running the pipeline</h1>

</section>
<section id="run-the-pipeline" class="slide level2">
<h2>Run the pipeline</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">tar_make</span>(<span class="at">as_job =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/workbench.png">
</center>
</section>
<section id="auto-scaled-distributed-computing" class="slide level2">
<h2>Auto-scaled distributed computing</h2>

<img data-src="./images/Slide10.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="auto-scaled-distributed-computing-1" class="slide level2">
<h2>Auto-scaled distributed computing</h2>

<img data-src="./images/Slide11.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="auto-scaled-distributed-computing-2" class="slide level2">
<h2>Auto-scaled distributed computing</h2>

<img data-src="./images/Slide12.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="auto-scaled-distributed-computing-3" class="slide level2">
<h2>Auto-scaled distributed computing</h2>

<img data-src="./images/Slide13.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="auto-scaled-distributed-computing-4" class="slide level2">
<h2>Auto-scaled distributed computing</h2>

<img data-src="./images/Slide14.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="auto-scaled-distributed-computing-5" class="slide level2">
<h2>Auto-scaled distributed computing</h2>

<img data-src="./images/Slide15.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="track-progress" class="slide level2">
<h2>Track progress</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">tar_progress_summary</span>()[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb25-2"><a href=""></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb25-3"><a href=""></a><span class="co">#&gt;   skipped dispatched completed</span></span>
<span id="cb25-4"><a href=""></a><span class="co">#&gt;     &lt;int&gt;      &lt;int&gt;     &lt;int&gt;</span></span>
<span id="cb25-5"><a href=""></a><span class="co">#&gt; 1       0        500     12613</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="track-progress-1" class="slide level2">
<h2>Track progress</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">tar_visnetwork</span>(<span class="at">targets_only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/graph-dispatched.png">
</center>
</section>
<section id="monitor-workers" class="slide level2">
<h2>Monitor workers</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">library</span>(crew.cluster)</span>
<span id="cb27-2"><a href=""></a>monitor <span class="ot">&lt;-</span> <span class="fu">crew_monitor_sge</span>()</span>
<span id="cb27-3"><a href=""></a></span>
<span id="cb27-4"><a href=""></a>monitor<span class="sc">$</span><span class="fu">jobs</span>()[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">9</span>)]</span>
<span id="cb27-5"><a href=""></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb27-6"><a href=""></a><span class="co">#&gt;   job_number name   state slots</span></span>
<span id="cb27-7"><a href=""></a><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb27-8"><a href=""></a><span class="co">#&gt; 1 131853812  crew-… r     4    </span></span>
<span id="cb27-9"><a href=""></a><span class="co">#&gt; 2 131853813  crew-… r     4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-results" class="slide level2">
<h2>Simulation results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">tar_read</span>(trials, <span class="at">branches =</span> <span class="fu">seq_len</span>(<span class="dv">8</span>))</span>
<span id="cb28-2"><a href=""></a><span class="co">#&gt; # A tibble: 10 × 4</span></span>
<span id="cb28-3"><a href=""></a><span class="co">#&gt;    events efficacy enrolled years</span></span>
<span id="cb28-4"><a href=""></a><span class="co">#&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb28-5"><a href=""></a><span class="co">#&gt;  1     40   0.055        58  6.31</span></span>
<span id="cb28-6"><a href=""></a><span class="co">#&gt;  2     50   0.0685       77  7.99</span></span>
<span id="cb28-7"><a href=""></a><span class="co">#&gt;  3     60   0.0602       81  7.93</span></span>
<span id="cb28-8"><a href=""></a><span class="co">#&gt;  4     70   0.153        93  9.01</span></span>
<span id="cb28-9"><a href=""></a><span class="co">#&gt;  5     40   0.220        65  6.03</span></span>
<span id="cb28-10"><a href=""></a><span class="co">#&gt;  6     50   0.479        73  6.43</span></span>
<span id="cb28-11"><a href=""></a><span class="co">#&gt;  7     60   0.918        87  8.91</span></span>
<span id="cb28-12"><a href=""></a><span class="co">#&gt;  8     70   0.832        89  8.99</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot" class="slide level2">
<h2>Plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a><span class="fu">tar_read</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/plot.png">
</center>
</section>
<section id="quarto-report-1" class="slide level2">
<h2>Quarto report</h2>
<div class="columns">
<div class="column" style="width:50%;">
<center>
<img src="./images/quarto-source.png">
</center>
</div><div class="column" style="width:50%;">
<center>
<img src="./images/quarto.png">
</center>
</div></div>
</section>
<section id="add-a-new-target" class="slide level2">
<h2>Add a new target</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb30-2"><a href=""></a>  <span class="at">name =</span> years,</span>
<span id="cb30-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">plot_years</span>(trials)</span>
<span id="cb30-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/graph-years.png">
</center>
</section>
<section id="skip-up-to-date-targets" class="slide level2">
<h2>Skip up-to-date targets</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">tar_make</span>()</span>
<span id="cb31-2"><a href=""></a><span class="co">#&gt; ...</span></span>
<span id="cb31-3"><a href=""></a><span class="co">#&gt; ✔ skipping targets (40002 so far)...</span></span>
<span id="cb31-4"><a href=""></a><span class="co">#&gt; ▶ dispatched target years</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="years-until-interim" class="slide level2">
<h2>Years until interim</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a><span class="fu">tar_read</span>(years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/years.png">
</center>
</section>
<section id="change-the-results-plot" class="slide level2">
<h2>Change the results plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb33-2"><a href=""></a>  <span class="at">name =</span> plot,</span>
<span id="cb33-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">plot_results</span>(trials, <span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb33-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/graph-change-plot.png">
</center>
</section>
<section id="change-an-event-threshold" class="slide level2">
<h2>Change an event threshold</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="fu">tar_target</span>(</span>
<span id="cb34-2"><a href=""></a>  <span class="at">name =</span> events,</span>
<span id="cb34-3"><a href=""></a>  <span class="at">command =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">75</span>)</span>
<span id="cb34-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/graph-change-event-threshold.png">
</center>
</section>
<section id="change-an-upstream-function" class="slide level2">
<h2>Change an upstream function</h2>
<center>
<img src="./images/graph-change-function.png">
</center>
</section>
<section id="up-to-date-pipeline" class="slide level2">
<h2>Up-to-date pipeline</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="fu">tar_outdated</span>()</span>
<span id="cb35-2"><a href=""></a><span class="co">#&gt; character(0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">tar_visnetwork</span>(<span class="at">targets_only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="./images/graph-uptodate.png">
</center>
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<center>
<img src="./images/plot-large-font.png" height="400px">
</center>
<div class="fragment">
<p>Interim at 40 events looks promising.</p>
</div>
<div class="fragment">
<p>Need to simulate full design with interims and final analysis</p>
</div>
</section></section>
<section>
<section id="recap" class="title-slide slide level1 center">
<h1>Recap</h1>

</section>
<section id="benefits-of-pipeline-tools" class="slide level2">
<h2>Benefits of pipeline tools</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<center>
<img src="./images/targets.png" height="400px">
</center>
</div><div class="column" style="width:50%;">
<center>
<div style="font-size: 2em;">
<ol type="1">
<li class="fragment">Time savings</li>
<li class="fragment">Reproducibility</li>
<li class="fragment">Peace of mind</li>
</ol>
</div>
</center>
</div></div>
</section>
<section id="thanks" class="slide level2">
<h2>Thanks!</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/useR.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/ropensci.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</section>
<section id="questions-app.wooclap.comuser25" class="slide level2">
<h2>Questions: <a href="https://app.wooclap.com/USER25?from=event-page">app.wooclap.com/USER25</a></h2>
<center>
<div id="" class="qrcode"></div>
<script type="text/javascript">
(function() {
  var script = document.currentScript;
  var qrcode = script.previousElementSibling;
  qrcode.qrcode = new QRCode(qrcode, {"colorDark":"#000000","colorLight":"#ffffff","height":"500","text":"https://app.wooclap.com/USER25?from=event-page","width":"500"});
  script.remove();
})();
</script>
    
</center>
</section>
<section id="slides-wlandau.github.iouser2025" class="slide level2">
<h2>Slides: <a href="https://wlandau.github.io/useR2025">wlandau.github.io/useR2025</a></h2>
<center>
<div id="" class="qrcode"></div>
<script type="text/javascript">
(function() {
  var script = document.currentScript;
  var qrcode = script.previousElementSibling;
  qrcode.qrcode = new QRCode(qrcode, {"colorDark":"#000000","colorLight":"#ffffff","height":"500","text":"https://wlandau.github.io/useR2025","width":"500"});
  script.remove();
})();
</script>
    
</center>
</section>
<section id="links-to-resources" class="slide level2">
<h2>Links to resources</h2>
<p><br></p>
<p><code>targets</code> documentation: <a href="https://docs.ropensci.org/targets" class="uri">https://docs.ropensci.org/targets</a></p>
<p><br></p>
<p>Clinical trial simulation pipeline: <a href="https://github.com/wlandau/targets-example-liver" class="uri">https://github.com/wlandau/targets-example-liver</a></p>
</section>
<section id="sources" class="slide level2 tiny">
<h2>Sources</h2>
<ul>
<li>Brilleman, S. L., M. J. Crowther, M. Moreno-Betancur, J. Buros Novik, and R. Wolfe. 2018. “Joint Longitudinal and Time-to-Event Models via Stan.” In StanCon 2018. https://github.com/stan-dev/stancon_talks/.</li>
<li>Dickson, E. R., T. R. Fleming, R. H. Wiesner, W. P. Baldus, C. R. Fleming, J. Ludwig, and J. T. McCall. 1985. “Trial of Penicillamine in Advanced Primary Biliary Cirrhosis.” New England Journal of Medicine 312 (16): 1011–15. https://doi.org/10.1056/NEJM198504183121602.</li>
<li>Goodrich, B., J. Gabry, I. Ali, and S. L. Brilleman. 2024. “rstanarm: Bayesian applied regression modeling via Stan.” https://mc-stan.org/rstanarm.</li>
<li>Landau, W. M., Kunzmann, K., Sidi, Y., Stock, C. 2024. “brms.mmrm: Bayesian MMRMs using ‘brms’”. R package version 1.1.1, <a href="https://openpharma.github.io/brms.mmrm/" class="uri">https://openpharma.github.io/brms.mmrm/</a>.</li>
<li>Landau, W. M. 2021. “The targets R package: a dynamic Make-like function-oriented pipeline toolkit for reproducibility and high-performance computing.” Journal of Open Source Software 6 (57): 2959. https://doi.org/10.21105/joss.02959.</li>
<li>Lawrence, G. A., M. E. Boye, M. J. Crowther, J. G. Ibrahim, G. Quartey, S. Micallef, and F. Y. Bois. 2016. “Joint modeling of survival and longitudinal non-survival data: current methods and issues. Report of the DIA Bayesian joint modeling working group.” Statistics in Medicine 34 (14): 2181–95. https://doi.org/10.1002/sim.6141.</li>
<li>Modrák, M., Moon, A. H., Kim, S., Bürkner, P., Huurre, N., Faltejsková, K., Gelman, A., Vehtari, A. 2023. “Simulation-Based Calibration Checking for Bayesian Computation: The Choice of Test Quantities Shapes Sensitivity”. Bayesian Analysis. <a href="https://doi.org/10.1214/23-BA1404" class="uri">https://doi.org/10.1214/23-BA1404</a>.</li>
<li>Therneau, T. M., and P. M. Grambsch. 2000. Modeling Survival Data: Extending the Cox Model. New York: Springer.</li>
</ul>
</section>
<section id="image-credit" class="slide level2 tiny">
<h2>Image credit</h2>
<ul>
<li><a href="https://xkcd.com/303/" class="uri">https://xkcd.com/303/</a></li>
<li><a href="https://unsplash.com/photos/brown-and-gray-stones-on-white-surface-hUjSO5dZA_E" class="uri">https://unsplash.com/photos/brown-and-gray-stones-on-white-surface-hUjSO5dZA_E</a></li>
<li><a href="https://unsplash.com/photos/person-stepping-on-blue-stairs-7_kRuX1hSXM" class="uri">https://unsplash.com/photos/person-stepping-on-blue-stairs-7_kRuX1hSXM</a></li>
<li><a href="https://unsplash.com/photos/red-white-and-black-round-wheel-RjqCk9MqhNg" class="uri">https://unsplash.com/photos/red-white-and-black-round-wheel-RjqCk9MqhNg</a></li>
<li><a href="https://unsplash.com/photos/matrix-movie-still-iar-afB0QQw" class="uri">https://unsplash.com/photos/matrix-movie-still-iar-afB0QQw</a></li>
<li><a href="https://unsplash.com/photos/black-and-gray-stethoscope-yo01Z-9HQAw" class="uri">https://unsplash.com/photos/black-and-gray-stethoscope-yo01Z-9HQAw</a></li>
<li><a href="https://unsplash.com/photos/white-printing-paper-with-numbers-Wpnoqo2plFA" class="uri">https://unsplash.com/photos/white-printing-paper-with-numbers-Wpnoqo2plFA</a></li>
<li><a href="https://unsplash.com/photos/woman-in-brown-sweater-covering-her-face-with-her-hand-_sh9vkVbVgo" class="uri">https://unsplash.com/photos/woman-in-brown-sweater-covering-her-face-with-her-hand-_sh9vkVbVgo</a></li>
<li><a href="https://unsplash.com/license" class="uri">https://unsplash.com/license</a></li>
<li><code>images/hmc.png</code>: Prof.&nbsp;David Kahle, Baylor University.</li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>© 2025 Eli Lilly and Company</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 100,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 100,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>